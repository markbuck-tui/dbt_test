
        merge into OPA_DEV.DBT_TEST.booking_fact_uk as DBT_INTERNAL_DEST
    using OPA_DEV.DBT_TEST.booking_fact_uk__dbt_tmp as DBT_INTERNAL_SOURCE

    
        on DBT_INTERNAL_SOURCE.bk_booking = DBT_INTERNAL_DEST.bk_booking
    

    
    when matched then update set
        BK_BOOKING = DBT_INTERNAL_SOURCE.BK_BOOKING,BK_PRIMARY_ACCOM = DBT_INTERNAL_SOURCE.BK_PRIMARY_ACCOM,BK_PRIMARY_ROOM = DBT_INTERNAL_SOURCE.BK_PRIMARY_ROOM,BK_FIRST_FLIGHT = DBT_INTERNAL_SOURCE.BK_FIRST_FLIGHT,BK_LAST_FLIGHT = DBT_INTERNAL_SOURCE.BK_LAST_FLIGHT,BK_SOURCE_MARKET = DBT_INTERNAL_SOURCE.BK_SOURCE_MARKET,BK_ORIGINATING_SYSTEM = DBT_INTERNAL_SOURCE.BK_ORIGINATING_SYSTEM,BK_BOOKING_TYPE = DBT_INTERNAL_SOURCE.BK_BOOKING_TYPE,BK_BOOKING_STATUS = DBT_INTERNAL_SOURCE.BK_BOOKING_STATUS,SOURCE_BOOKING_ID = DBT_INTERNAL_SOURCE.SOURCE_BOOKING_ID,SOURCE_BOOKING_VERSION = DBT_INTERNAL_SOURCE.SOURCE_BOOKING_VERSION,BOOKING_CREATED_DATETIME = DBT_INTERNAL_SOURCE.BOOKING_CREATED_DATETIME,BOOKING_CONFIRMED_DATETIME = DBT_INTERNAL_SOURCE.BOOKING_CONFIRMED_DATETIME,BOOKING_CANCELLED_DATETIME = DBT_INTERNAL_SOURCE.BOOKING_CANCELLED_DATETIME,GROUP_SEASON = DBT_INTERNAL_SOURCE.GROUP_SEASON,SM_SEASON = DBT_INTERNAL_SOURCE.SM_SEASON,CHANNEL_CODE = DBT_INTERNAL_SOURCE.CHANNEL_CODE,CHANNEL_DESC = DBT_INTERNAL_SOURCE.CHANNEL_DESC,BOOKED_BOARD_CODE = DBT_INTERNAL_SOURCE.BOOKED_BOARD_CODE,BOOKED_BOARD_NAME = DBT_INTERNAL_SOURCE.BOOKED_BOARD_NAME,MULTI_ROOM_BOOKING = DBT_INTERNAL_SOURCE.MULTI_ROOM_BOOKING,NUMBER_OF_BOOKED_ROOMS = DBT_INTERNAL_SOURCE.NUMBER_OF_BOOKED_ROOMS,MULTI_CENTRE_BOOKING = DBT_INTERNAL_SOURCE.MULTI_CENTRE_BOOKING,DEPARTURE_DATE = DBT_INTERNAL_SOURCE.DEPARTURE_DATE,RETURN_DATE = DBT_INTERNAL_SOURCE.RETURN_DATE,DURATION = DBT_INTERNAL_SOURCE.DURATION,STD_NUMBER_OF_BOOKING_ADULT_PAX = DBT_INTERNAL_SOURCE.STD_NUMBER_OF_BOOKING_ADULT_PAX,STD_NUMBER_OF_BOOKING_CHILD_PAX = DBT_INTERNAL_SOURCE.STD_NUMBER_OF_BOOKING_CHILD_PAX,STD_NUMBER_OF_BOOKING_INFANT_PAX = DBT_INTERNAL_SOURCE.STD_NUMBER_OF_BOOKING_INFANT_PAX,STD_NUMBER_OF_BOOKING_PAX = DBT_INTERNAL_SOURCE.STD_NUMBER_OF_BOOKING_PAX,SM_NUMBER_OF_BOOKING_ADULT_PAX = DBT_INTERNAL_SOURCE.SM_NUMBER_OF_BOOKING_ADULT_PAX,SM_NUMBER_OF_BOOKING_TEENAGER_PAX = DBT_INTERNAL_SOURCE.SM_NUMBER_OF_BOOKING_TEENAGER_PAX,SM_NUMBER_OF_BOOKING_CHILD_PAX = DBT_INTERNAL_SOURCE.SM_NUMBER_OF_BOOKING_CHILD_PAX,SM_NUMBER_OF_BOOKING_INFANT_PAX = DBT_INTERNAL_SOURCE.SM_NUMBER_OF_BOOKING_INFANT_PAX,SM_NUMBER_OF_BOOKING_PAX = DBT_INTERNAL_SOURCE.SM_NUMBER_OF_BOOKING_PAX,PRIMARY_GATEWAY = DBT_INTERNAL_SOURCE.PRIMARY_GATEWAY,SM_CURRENCY = DBT_INTERNAL_SOURCE.SM_CURRENCY,SM_REVENUE = DBT_INTERNAL_SOURCE.SM_REVENUE,SM_CNX_AND_AMEND_REVENUE = DBT_INTERNAL_SOURCE.SM_CNX_AND_AMEND_REVENUE,SM_ACCOMMODATION_COSTS = DBT_INTERNAL_SOURCE.SM_ACCOMMODATION_COSTS,SM_EARLY_BOOKING_DISCOUNTS = DBT_INTERNAL_SOURCE.SM_EARLY_BOOKING_DISCOUNTS,SM_LATE_BOOKING_DISCOUNTS = DBT_INTERNAL_SOURCE.SM_LATE_BOOKING_DISCOUNTS,SM_FLYING_COSTS = DBT_INTERNAL_SOURCE.SM_FLYING_COSTS,SM_OTHER_COSTS = DBT_INTERNAL_SOURCE.SM_OTHER_COSTS,SM_DISTRIBUTION_COSTS = DBT_INTERNAL_SOURCE.SM_DISTRIBUTION_COSTS,SM_NON_MARGIN_ITEMS = DBT_INTERNAL_SOURCE.SM_NON_MARGIN_ITEMS,SM_MARGIN = DBT_INTERNAL_SOURCE.SM_MARGIN,SMG_CURRENCY = DBT_INTERNAL_SOURCE.SMG_CURRENCY,SMG_REVENUE = DBT_INTERNAL_SOURCE.SMG_REVENUE,SMG_CNX_AND_AMEND_REVENUE = DBT_INTERNAL_SOURCE.SMG_CNX_AND_AMEND_REVENUE,SMG_ACCOMMODATION_COSTS = DBT_INTERNAL_SOURCE.SMG_ACCOMMODATION_COSTS,SMG_EARLY_BOOKING_DISCOUNTS = DBT_INTERNAL_SOURCE.SMG_EARLY_BOOKING_DISCOUNTS,SMG_LATE_BOOKING_DISCOUNTS = DBT_INTERNAL_SOURCE.SMG_LATE_BOOKING_DISCOUNTS,SMG_FLYING_COSTS = DBT_INTERNAL_SOURCE.SMG_FLYING_COSTS,SMG_OTHER_COSTS = DBT_INTERNAL_SOURCE.SMG_OTHER_COSTS,SMG_DISTRIBUTION_COSTS = DBT_INTERNAL_SOURCE.SMG_DISTRIBUTION_COSTS,SMG_NON_MARGIN_ITEMS = DBT_INTERNAL_SOURCE.SMG_NON_MARGIN_ITEMS,SMG_MARGIN = DBT_INTERNAL_SOURCE.SMG_MARGIN,REP_CURRENCY = DBT_INTERNAL_SOURCE.REP_CURRENCY,REP_REVENUE = DBT_INTERNAL_SOURCE.REP_REVENUE,REP_CNX_AND_AMEND_REVENUE = DBT_INTERNAL_SOURCE.REP_CNX_AND_AMEND_REVENUE,REP_ACCOMMODATION_COSTS = DBT_INTERNAL_SOURCE.REP_ACCOMMODATION_COSTS,REP_EARLY_BOOKING_DISCOUNTS = DBT_INTERNAL_SOURCE.REP_EARLY_BOOKING_DISCOUNTS,REP_LATE_BOOKING_DISCOUNTS = DBT_INTERNAL_SOURCE.REP_LATE_BOOKING_DISCOUNTS,REP_FLYING_COSTS = DBT_INTERNAL_SOURCE.REP_FLYING_COSTS,REP_OTHER_COSTS = DBT_INTERNAL_SOURCE.REP_OTHER_COSTS,REP_DISTRIBUTION_COSTS = DBT_INTERNAL_SOURCE.REP_DISTRIBUTION_COSTS,REP_NON_MARGIN_ITEMS = DBT_INTERNAL_SOURCE.REP_NON_MARGIN_ITEMS,REP_MARGIN = DBT_INTERNAL_SOURCE.REP_MARGIN,FFD_FLAG = DBT_INTERNAL_SOURCE.FFD_FLAG,RECORD_TYPE = DBT_INTERNAL_SOURCE.RECORD_TYPE,EFFECTIVE_FROM = DBT_INTERNAL_SOURCE.EFFECTIVE_FROM,EFFECTIVE_TO = DBT_INTERNAL_SOURCE.EFFECTIVE_TO,SM_CREATED_DATETIME = DBT_INTERNAL_SOURCE.SM_CREATED_DATETIME,SM_UPDATED_DATETIME = DBT_INTERNAL_SOURCE.SM_UPDATED_DATETIME,DM_CREATED_DATETIME = DBT_INTERNAL_SOURCE.DM_CREATED_DATETIME,LATEST_RECORD_INDICATOR = DBT_INTERNAL_SOURCE.LATEST_RECORD_INDICATOR
    

    when not matched then insert
        (BK_BOOKING, BK_PRIMARY_ACCOM, BK_PRIMARY_ROOM, BK_FIRST_FLIGHT, BK_LAST_FLIGHT, BK_SOURCE_MARKET, BK_ORIGINATING_SYSTEM, BK_BOOKING_TYPE, BK_BOOKING_STATUS, SOURCE_BOOKING_ID, SOURCE_BOOKING_VERSION, BOOKING_CREATED_DATETIME, BOOKING_CONFIRMED_DATETIME, BOOKING_CANCELLED_DATETIME, GROUP_SEASON, SM_SEASON, CHANNEL_CODE, CHANNEL_DESC, BOOKED_BOARD_CODE, BOOKED_BOARD_NAME, MULTI_ROOM_BOOKING, NUMBER_OF_BOOKED_ROOMS, MULTI_CENTRE_BOOKING, DEPARTURE_DATE, RETURN_DATE, DURATION, STD_NUMBER_OF_BOOKING_ADULT_PAX, STD_NUMBER_OF_BOOKING_CHILD_PAX, STD_NUMBER_OF_BOOKING_INFANT_PAX, STD_NUMBER_OF_BOOKING_PAX, SM_NUMBER_OF_BOOKING_ADULT_PAX, SM_NUMBER_OF_BOOKING_TEENAGER_PAX, SM_NUMBER_OF_BOOKING_CHILD_PAX, SM_NUMBER_OF_BOOKING_INFANT_PAX, SM_NUMBER_OF_BOOKING_PAX, PRIMARY_GATEWAY, SM_CURRENCY, SM_REVENUE, SM_CNX_AND_AMEND_REVENUE, SM_ACCOMMODATION_COSTS, SM_EARLY_BOOKING_DISCOUNTS, SM_LATE_BOOKING_DISCOUNTS, SM_FLYING_COSTS, SM_OTHER_COSTS, SM_DISTRIBUTION_COSTS, SM_NON_MARGIN_ITEMS, SM_MARGIN, SMG_CURRENCY, SMG_REVENUE, SMG_CNX_AND_AMEND_REVENUE, SMG_ACCOMMODATION_COSTS, SMG_EARLY_BOOKING_DISCOUNTS, SMG_LATE_BOOKING_DISCOUNTS, SMG_FLYING_COSTS, SMG_OTHER_COSTS, SMG_DISTRIBUTION_COSTS, SMG_NON_MARGIN_ITEMS, SMG_MARGIN, REP_CURRENCY, REP_REVENUE, REP_CNX_AND_AMEND_REVENUE, REP_ACCOMMODATION_COSTS, REP_EARLY_BOOKING_DISCOUNTS, REP_LATE_BOOKING_DISCOUNTS, REP_FLYING_COSTS, REP_OTHER_COSTS, REP_DISTRIBUTION_COSTS, REP_NON_MARGIN_ITEMS, REP_MARGIN, FFD_FLAG, RECORD_TYPE, EFFECTIVE_FROM, EFFECTIVE_TO, SM_CREATED_DATETIME, SM_UPDATED_DATETIME, DM_CREATED_DATETIME, LATEST_RECORD_INDICATOR)
    values
        (BK_BOOKING, BK_PRIMARY_ACCOM, BK_PRIMARY_ROOM, BK_FIRST_FLIGHT, BK_LAST_FLIGHT, BK_SOURCE_MARKET, BK_ORIGINATING_SYSTEM, BK_BOOKING_TYPE, BK_BOOKING_STATUS, SOURCE_BOOKING_ID, SOURCE_BOOKING_VERSION, BOOKING_CREATED_DATETIME, BOOKING_CONFIRMED_DATETIME, BOOKING_CANCELLED_DATETIME, GROUP_SEASON, SM_SEASON, CHANNEL_CODE, CHANNEL_DESC, BOOKED_BOARD_CODE, BOOKED_BOARD_NAME, MULTI_ROOM_BOOKING, NUMBER_OF_BOOKED_ROOMS, MULTI_CENTRE_BOOKING, DEPARTURE_DATE, RETURN_DATE, DURATION, STD_NUMBER_OF_BOOKING_ADULT_PAX, STD_NUMBER_OF_BOOKING_CHILD_PAX, STD_NUMBER_OF_BOOKING_INFANT_PAX, STD_NUMBER_OF_BOOKING_PAX, SM_NUMBER_OF_BOOKING_ADULT_PAX, SM_NUMBER_OF_BOOKING_TEENAGER_PAX, SM_NUMBER_OF_BOOKING_CHILD_PAX, SM_NUMBER_OF_BOOKING_INFANT_PAX, SM_NUMBER_OF_BOOKING_PAX, PRIMARY_GATEWAY, SM_CURRENCY, SM_REVENUE, SM_CNX_AND_AMEND_REVENUE, SM_ACCOMMODATION_COSTS, SM_EARLY_BOOKING_DISCOUNTS, SM_LATE_BOOKING_DISCOUNTS, SM_FLYING_COSTS, SM_OTHER_COSTS, SM_DISTRIBUTION_COSTS, SM_NON_MARGIN_ITEMS, SM_MARGIN, SMG_CURRENCY, SMG_REVENUE, SMG_CNX_AND_AMEND_REVENUE, SMG_ACCOMMODATION_COSTS, SMG_EARLY_BOOKING_DISCOUNTS, SMG_LATE_BOOKING_DISCOUNTS, SMG_FLYING_COSTS, SMG_OTHER_COSTS, SMG_DISTRIBUTION_COSTS, SMG_NON_MARGIN_ITEMS, SMG_MARGIN, REP_CURRENCY, REP_REVENUE, REP_CNX_AND_AMEND_REVENUE, REP_ACCOMMODATION_COSTS, REP_EARLY_BOOKING_DISCOUNTS, REP_LATE_BOOKING_DISCOUNTS, REP_FLYING_COSTS, REP_OTHER_COSTS, REP_DISTRIBUTION_COSTS, REP_NON_MARGIN_ITEMS, REP_MARGIN, FFD_FLAG, RECORD_TYPE, EFFECTIVE_FROM, EFFECTIVE_TO, SM_CREATED_DATETIME, SM_UPDATED_DATETIME, DM_CREATED_DATETIME, LATEST_RECORD_INDICATOR)
      
    